<?php
session_start();
$mysql_host = "mysql5.000webhost.com";
$mysql_database = "a3940063_roundup";
$mysql_user = "a3940063_cloudy";
$mysql_password = "6doubles";
if(!(isset($_SESSION['username']) && !empty($_SESSION['username']))){
	header('Location: Events.html');
}
?>
<html>
	<head>
		<title>Sportsman Roundup: Add an Event</title>
		<link rel="stylesheet" href="http://code.jquery.com/ui/1.9.2/themes/base/jquery-ui.css" />
		<script src="http://code.jquery.com/jquery-latest.min.js"></script>
    	<script src="http://code.jquery.com/ui/1.9.2/jquery-ui.js"></script>
    	<script src="script/jquery-ui-timepicker-addon.js"></script>
    	<script src="script/jquery-ui-sliderAccess.js"></script>
    	<link rel="stylesheet" href="style/jquery-ui-timepicker-addon.css"/>
    	<script>
    		$(function() {
        		$( "#datepicker" ).datepicker({
            		showOn: "button",
		            buttonImage: "/images/calendar-blue.GIF",
        	    	buttonImageOnly: true,
        	    	minDate:0
        		});
        		$('#timepicker').timepicker({
        			showOn: "button",
        			pickerTimeFormat:"hh:mm tt",
        			timeFormat: "hh:mm tt",
        			buttonImage: "/images/clock-blue.png",
        			buttonImageOnly: true
        		});
        		
    		});
    		String.prototype.Trim = function(){
    			return this.replace(/^\s+|\s+$/g,"");
    		}
    		function validate(){
    			var errorFields = new Array();
    			var errors = new Array();
    			var pageError = false;
    			var inputs = document.formEvent.getElementsByTagName("input");
    			for(x=0;x<inputs.length;x++){
    				var input = inputs[x].value.Trim();
    				if(!inputs[x].name=="location"){
    					if(input==""){
    						errors.push(inputs[x].name.substr(0,1).toUpperCase() + inputs[x].name.substr(1) + " cannot be blank");
    						pageError = true;
    					}
    				}
    			}
    			input = document.formEvent.state.value.Trim();
    			if(input==""){
    				errors.push("State cannot be blank");
    				pageError = true;
    			}
    			if(pageError){
    				var errDiv = document.getElementById("error_explanation");
    				errDiv.innerHTML="";
    				errDiv.style.display="";
    				var element = document.createElement("h2");
    				element.innerHTML = "There " + ((errors.length==1)?"is ":"are ") + errors.length + ((errors.length==1)?" error":" errors");
    				errDiv.appendChild(element);
    				element = document.createElement("br");
    				errDiv.appendChild(element);
    				var listElement = document.createElement("ul");
    				for(x=0;x<errors.length;x++){
    					element = document.createElement("li");
    					element.innerHTML=errors[x];
    					listElement.appendChild(element);
    				}
    				errDiv.appendChild(listElement);
    			}
    			else{
    				document.formEvent.submit();
    			}

    		}
    		function formSubmit(){

    		}
    	</script>
		<style>
			#header{
				width:100%;
				margin:0 auto;
				margin-bottom: 100px;
				border-bottom:solid;
				border-color:black;
				background:#5C8533;
				color:white;
			}
			#roundup{
				max-width:56.25em;
				margin:0 auto;
			}
			#content{
				max-width:56.25em;
				margin:0px auto;
				padding:0 1em;
			
			}
			#info, #enter{
				text-align: center;
			}
			#event{
				display:-webkit-box;
				-webkit-box-orient:horizontal;
				-webkit-box-pack:center;
				-webkit-box-align:center;
			}
			#footer{
				position:relative;
				bottom:0;
				margin-top:50px;
				text-align:right;
			}
			#header img{
				height:6.25em;
			}
			#event label{
				display:inline-block;
				width:6.25em;
				font-size:1.25em;
			}
			#enter{
				width:50%;
			}
			#add, #cancel{
				width:100px;
				background-color:#FCFBFA;
			}
			#error_explanation {
				margin-left:11%;
				margin-bottom:20px;
  				width: 400px;                  
  				border: 2px solid red;         
  				padding: 7px;  
  				padding-bottom: 12px;          
  				background-color: #ECE6E0; 
  				box-shadow: -10px 10px 5px #888888;    
			}         
			#error_explanation h2 {       
			  	text-align: left;           
			  	font-weight: bold;          
				padding: 5px 5px 5px 15px;  
				font-size: 12px;            
				margin: -7px;               
				background-color: #CC3300;  
				color: #fff;                
			}                              
			#error_explanation p {        
			  color: #333;                
			  margin-bottom: 0;           
			  padding: 5px;               
			}                             
			#error_explanation ul li {    
			  font-size: 12px;            
			  list-style: square;         
			}                                                    
			.shadowArea{
				margin:0 auto;
				width:78%;
				background:#E0D6CC;
				border-radius:25px;
				padding:1em 1em;
				box-shadow: -10px 10px 5px #888888;
			}
			.error{
				color:#CC3300;
			}
			#siteLinks a{
				margin-left: 15px;
			}
			body{
				margin:0;
				padding:0;
				border:0;
			}
			h6,form,h1{
				display:inline;
			}
			input,select,span.select{
				-webkit-border-radius:5px; 
   				-moz-border-radius:5px; 
   				border-radius:5px; 
   				-webkit-box-shadow:-5px 5px 5px #9D968F; 
   				-moz-box-shadow:-5px 5px 5px #9D968F; 
   				box-shadow:-5px 5px 5px #9D968F; 
			}
		</style>
	</head>
	<body>
		<div id="header">
			<div id="roundup">
				<img src="/images/roundup.jpg"/><h1>SPORTSMAN ROUNDUP</h1>
				<br>
				<span id="siteLinks"><a href="Events.html">Events</a><a href="UserProfile.html">My Profile</a><a href="signOut.php">Sign Out</a></span>
			</div>
		</div>
		<div id="content">
			<div id="error_explanation" style="display:none;">
			</div>
			<div id="info" class="shadowArea">
				<?php
					echo (($_SESSION['success'])? "<p>Your event was added.</p>":"");
					unset($_SESSION['success']);
				?>
				<p>Enter your event in the following form.</p>
			</div>

			<br><br>

			<div id="event" class="shadowArea">
				<form name="formEvent" action="addUserEvent.php" method="post">
					<label>Name of Event</label><input size="50" name="event"><br><br>
					<label>Date of Event</label><input size="10" name="date" id="datepicker" value=""><br><br>
					<label>Time of Event</label><input size="10" name="time" id="timepicker" value=""><br><br>
					<label>Location of Event</label><input size="50" name="location"><br><br>
					<label>City</label><input size="25" name="city">&nbsp;<label>State</label>
						<span class="select">
							<select name="state">
								<option value=""></option>
								<?php
									$con = mysql_connect($mysql_host,$mysql_user,$mysql_password);
									mysql_select_db($mysql_database,$con);
									$result = mysql_query("SELECT * FROM states");
									while($row = mysql_fetch_array($result))
									{
										echo "<option value=" . $row['abbr'] .">" . $row['abbr'] . "</option>";
									}
									mysql_close($con);
									?>
							</select>
						</span>
					<br><br>
					<label>Website of Event</label><input size="50" name="website"><br>
				</form>
			</div>

			<br><br><br><br>

			<div id="enter" class="shadowArea">
				<input type="button" id="add" name="add" value="Add Event" onClick="validate()"> <input type="button" id="cancel" name="cancel" value="Cancel">
			</div>

			<div id="footer">
				<h6>2012 A Postmaster Production</h6>
			</div>
		</div>
	</body>
</html>